\todo{write introduction + motivation (latter being the justification for naming it graph ``Laplacian'' earlier)}
In the following we will deal with a compact manifold $\Man$ that is $C^\infty$. Let $x$ be a fixed point, not on the on the boundary, $T_x\Man$ be the tangent space to $\Man$ at $x$ and $(e_1,\dots,e_d)$ be a fixed orthonormal basis of $T_x\Man$. Furthermore two systems of local coordinates will be introduced:
\begin{enumerate}
\item \textit{(Normal coordinates)} The exponential map $exp_x$ generates a set of orthogonal geodesics $(\gamma_1,\dots,\gamma_d)$ intersecting at x with initial velocity $(e_1,\dots,e_d)$. Now every point $y\in\Man$ in a sufficiently small neighborhood of $x$ has a set of \textit{normal coordinates} $(s_1,\dots,s_d)$ along these geodesics.
\item \textit{(Tangent coordinates)} Considering the orthogonal projection $u$ of $y$ on $T_x\Man$, where $u_i = \langle y-x,e_i\rangle$ in $(e_1,\dots,e_d)$, we get a system of \textit{tangent coordinates}. The submanifold is now locally parameterized as $y=(u,g(u))$, where $g:\Real^d \rightarrow \Real^{n-d}$. Since $u=(u_1,\dots,u_d)$ are tangent coordinates, we must have that $\partial g(0)=0$.
\end{enumerate}
Notice that, locally, any function $f$ on $\Man$ may be viewed as $\tilde{f}$ of $(s_1,\dots,s_d)$ and thus we may write $\Delta f(x)=-\sum_{i=1}^d \frac{\partial^2\tilde{f}}{\partial s_i^2}(0,\dots,0)$, where $\Delta$ is the Laplace-Beltrami operator on $\Man$.



\section{Comparison of the Geodesic and the Local Projection}\todo{The following is basically a citation of \cite{Coifman20065}.}
In this section we will compute asymptotic expansions for the changes of variable $u\mapsto (s_1,\dots,s_d)$ and $u\mapsto y$.

In the following, $Q_{x,m}(u)$ denotes a generic homogeneous polynomial of degree $m$ of the variable $u = (u_1,\dots,u_d)$, whose coefficient depends on $x$.

\begin{lemma}
If $y\in\Man$ is in a Euclidean ball of radius $\eps^\frac{1}{2}$ around $x$, then, for $\eps$ sufficiently small, there exists:
\begin{equation}\label{eq:geodOrder3}
s_i=u_i+Q_{x,3}(u)+\mathcal{O}(\eps^2)
\end{equation}
\end{lemma}

\begin{proof}
Let $\gamma$ be the geodesic connection $x$ and $y$ parameterized by arclength. We have $\gamma(0)=x$ and let $s$ be such that $\gamma(s)=y$. If $y$ has normal coordinates $(s_1,\dots,s_d)$, then we have $s\gamma'(0)=(s_1,\dots,s_d)$. A Taylor expansion yields
\begin{equation*}
\gamma(s)=\gamma(0)+s\gamma'(0)+\frac{s^2}{2}\gamma''(0)+\frac{s^3}{6}\gamma^{(3)}(0)+\mathcal{O}(\eps^2).
\end{equation*}
By definition of a geodesic, the covariant derivative of the velocity is zero, which means that $\gamma''(0)$ is orthogonal to the tangent plane at $x$. Now since the parameter $u_i$ is defined by $u_i=\langle\gamma(s)-\gamma(0),e_i\rangle$, we obtain that $u_i=s_i+\frac{s^3}{6}\langle\gamma^{(3)}(0),e_i\rangle+\mathcal{O}(\eps^2)$. Iterating this equation yields the result.
\end{proof}

\begin{lemma}
Again, let $y\in\Man$ be in a Euclidean ball of radius $\eps^\frac{1}{2}$ around $x$; we have
\begin{equation}\label{eq:metricComparison}
||x-y||^2=||u||^2+Q_{x,4}(u)+Q_{x,4}(u)+\mathcal{O}(\eps^3)
\end{equation}
and
\begin{equation}\label{eq:volumeComparison}
det\left(\frac{dy}{du}\right)=1+Q_{x,2}(u)+Q_{x,3}(u)+\mathcal{O}(\eps^2).
\end{equation}
\end{lemma}

\begin{proof}
The submanifold is locally parameterized as $u\mapsto(u,g(u))$, where $g:\Real^d\rightarrow\Real^{n-d}$. Writing $g=(g_{i+1},\dots,g_n)$ and applying Pythagore's theorem, we obtain
\begin{equation*}
||x-y||^2=||u||^2+\sum_{i=d+1}^n g_i(u)^2.
\end{equation*}
Using that, by definition, $g_i(0)=0$ and, as noted before, $\frac{\partial g}{\partial u_i}(0)=0$. As a consequence $g_i(u)=b_{i,x}(u)+c_{i,x}(u)+\mathcal{O}(\eps^2)$, where $b_{i,x}$ is the Hessian quadratic form of $g_i$ at $u=0$ and $c_{i,x}$ is the cubic term. This proves \eqref{eq:metricComparison} with
\begin{equation*}
Q_{x,4}(u)=\sum_{i=d+1}^n b_{i,x}^2(u) \text{ and } Q_{x,5}(u)=2\sum_{i=d+1}^n b_{i,x}(u)c_{i,x}(u).
\end{equation*}

To prove \eqref{eq:volumeComparison}, observe that $\frac{\partial g}{\partial u_i}(0)=0$ implies that $\frac{\partial g}{\partial u_i}(0)=\tilde{b}_{i,x}(u)+\tilde{c}_{i,x}(u)+\mathcal{O}(\eps^\frac{3}{2})$, where $\tilde{b}_{i,x}(u)$ and $\tilde{c}_{i,x}(u)$ are the linear and quadratic terms in the Taylor expansion of $\frac{\partial g}{\partial u_i}(0)$ at $0$. We thus have:

\begin{equation*}\begin{aligned}
\frac{\partial y}{\partial u_i}(u)&=\left(v_i,\frac{\partial g}{\partial u_i}(u)\right), \text{ where } v_i=(0,\dots,0,1,0,\dots,0)\in\Real^d \\
&=(v_i,\tilde{b}_{i,x}(u)+\tilde{c}_{i,x}(u)+\mathcal{O}(\eps^\frac{3}{2}).
\end{aligned}\end{equation*}

The squared volume generated by these $d$ vectors is the determinant of their Gram matrix, i.e.,

\begin{equation*}
\left| det\left(\frac{dy}{du} \right)\right|^2=\sum_{i,j=1}^d E_{ij}(u)+\sum_{i,j=1}^d F_{ij}(u)+\mathcal{O}(\eps^2),
\end{equation*}

where

\begin{equation*}
E_{ij}(u)=\langle \tilde{b}_{i,x}(u),\tilde{b}_{j,x}(u)\rangle \text{ and } F_{ij}(u)=\langle \tilde{b}_{i,x}(u),\tilde{c}_{j,x}(u)\rangle + \langle \tilde{c}_{i,x}(u),\tilde{b}_{j,x}(u)\rangle.
\end{equation*}

Defining

\begin{equation*}
Q_{x,2}(u)=\sum_{i,j=1}^d E_{ij}(u) \text{ and } Q_{x,3}(u)=\sum_{i,j=1}^d F_{ij}(u),
\end{equation*}

we obtain the last result.
\end{proof}



\section{Infinitesimal Operators for a Family of Graph Laplacians}
In this section we present the calculation of the infinitesimal generators for the different diffusion maps characterized by a parameter $\alpha$.

To start with we first show an asymptotic expansion for diffusion operators $G_\eps$.

Let $k_\eps(x,y)$ be an isotropic kernel, i.e.:

\begin{equation*}
k_\eps(x,y)=h\left(\frac{||x-y||^2}{\eps} \right),
\end{equation*}

where $h$ is assumed to have an exponential decay and let $G_\eps$ be the corresponding operator

\begin{equation*}
G_\eps f(x)=\frac{1}{\eps^\frac{d}{2}}\int_\Man k_\eps(x,y)f(y)dy.
\end{equation*}

The idea is that, using the previous lemmata, for small $\eps$ integrating $f$ against the kernel on the manifold is approximately like integrating on the tangent space.

\begin{theorem}\label{thm:diffOpExpansion}
Let $f\in C^3(\Man)$ and let $0 <\gamma<1/2$. Then we have, uniformly for all $x\in\Man$ at distance larger than $\eps^\gamma$ from $\partial\Man$,

\begin{equation*}
G_\eps f(x)=m_0 f(x)+\eps\frac{m_2}{2}\left(\omega(x)f(x)-\Delta f(x) \right)+\mathcal{O}(\eps^2),
\end{equation*}

where

\begin{equation*}
m_0=\int_{\Real^d} h(||u||^2)du \text{ and } m_2=\int_{\Real^d} u_1^2 h(||u||^2)du
\end{equation*}

and $\omega$ is a potential term depending on the embedding of $\Man$.
\end{theorem}

\begin{proof}
Because of the exponential decay of $h$, the domain of integration can be restricted to the intersection of $\Man$ with the ball of radius $\eps^\gamma$ around $x$. In doing so we generate an error of order

\begin{equation*}\begin{aligned}
\Bigg|\frac{1}{\eps^\frac{d}{2}}\bigintsss\limits_{\substack{y\in\Man \\ ||x-y||>\eps^\gamma}} h\left(\frac{||x-y||^2}{\eps} \right)f(y)dy \Bigg|&\leq
||f||_\infty \frac{1}{\eps^\frac{d}{2}}\bigintsss\limits_{\substack{y\in\Man \\ ||x-y||>\eps^\gamma}} \left|h\left(\frac{||x-y||^2}{\eps} \right)\right|dy \\
&\leq ||f||_\infty \int\limits_{\substack{y\in\Man \\ ||y||>\eps^{\gamma-1/2}}} |h(||y||^2)|dy \\
&\leq C||f||_\infty Q(\eps^{1/2-\gamma})e^{-\eps^{\gamma-1/2}},
\end{aligned}\end{equation*}

where we have used the exponential decay of the kernel and where $Q$ is a polynomial. Since $0<\gamma<1/2$, this term is exponentially small and is bounded by $\mathcal{O}(\eps^{\frac{3}{2}})$. Therefore,

\begin{equation*}
G_\eps f(x)=\frac{1}{\eps^\frac{d}{2}}\bigintsss\limits_{\substack{y\in\Man \\ ||x-y||<\eps^\gamma}} h\left(\frac{||x-y||^2}{\eps} \right)f(y)dy+\mathcal{O}(\eps^\frac{3}{2}).
\end{equation*}

Now that things are localized around $x$, we can Taylor-expand the function $(s_1,\dots,s_d)\mapsto f(y(s_1,\dots,s_d))$:

\begin{equation*}
f(y)=f(x)+\sum_{i=1}^d s_i \frac{\partial\tilde{f}}{\partial s_i}(0)+\frac{1}{2}\sum_{i,j=1}^d s_i s_j \frac{\partial^2\tilde{f}}{\partial s_i\partial s_j}(0)+Q_{x,3}(s_1,\dots,s_d)+\mathcal{O}(\eps^2),
\end{equation*}

where $\tilde{f}(s_1,\dots,s_d)=f(y(s_1,\dots,s_d))$. Invoking \eqref{eq:geodOrder3}, we obtain

\begin{equation*}
f(y)=\tilde{f}(0)+\sum_{i=1}^d u_i \frac{\partial \tilde{f}}{\partial s_i}(0)+\frac{1}{2}\sum_{i,j=1}^d u_i u_j \frac{\partial^2\tilde{f}}{\partial s_i\partial s_j}(0)+Q_{x,3}(u)+\mathcal{O}(\eps^2).
\end{equation*}

Likewise, because of \eqref{eq:metricComparison}, the Taylor expansion of the kernel is

\begin{equation*}
h\left(\frac{||x-y||^2}{\eps} \right)=h\left(\frac{||u||^2}{\eps} \right) +\left(\frac{Q_{x,4}(u)+Q_{x,5}(u)}{\eps} \right) h'\left(\frac{||u||^2}{\eps} \right) + \mathcal{O}(\eps^2).
\end{equation*}

Using \eqref{eq:volumeComparison} to change the variable $s\mapsto u$ in the previous integral defining $G_\eps f(x)$ yields:

\begin{equation*}\begin{aligned}
\eps^\frac{d}{2} G_\eps f(x) =& \bigintsss\limits_{||u||<\eps^\gamma} \left[h\left(\frac{||u||^2}{\eps}\right)+\left(\frac{Q_{x,4}(u)+Q_{x,5}(u)}{\eps}\right)h'\left(\frac{||u||^2}{\eps}\right)\right]\\
&\times \left[\tilde{f}(0)+ \sum\limits_{i=1}^d u_i \frac{\partial \tilde{f}}{\partial s_i}(0)+\frac{1}{2}\sum\limits_{i,j=1}^d u_i u_j \frac{\partial^2\tilde{f}}{\partial s_i\partial s_j}(0)+Q_{x,3}(u)\right]\\
&\times \left(1+Q_{x,2}(u)+Q_{x,3}(u)\right)du + \mathcal{O}\left(\eps^{\frac{d}{2}+2} \right).
\end{aligned}\end{equation*}

This identity can be dramatically simplified by identifying odd functions and setting their integral to zero. One is left with

\begin{equation*}\begin{aligned}
\eps^\frac{d}{2} G_\eps f(x)=&\tilde{f}(0)\bigintsss_{\Real^d}h\left(\frac{||u||^2}{\eps} \right)du+\frac{1}{2}\left(\sum_{i=1}^d \frac{\partial^2\tilde{f}}{\partial s_i^2}(0) \right)\bigintsss_{\Real^d}u_1^2 h\left( \frac{||u||^2}{\eps} \right)du\\
+&\tilde{f}(0)\bigintsss_{\Real^d}\left[\frac{Q_{x,4}(u)}{\eps}h'\left(\frac{||u||^2}{\eps}\right)+\tilde{Q}_{x,2}(u) h\left(\frac{||u||^2}{\eps} \right) \right]du+\mathcal{O}\left(\eps^{\frac{d}{2}+2} \right),
\end{aligned}\end{equation*}

where the domain of integration has been extended to $\Real^d$ (exponential decay of $h$). Changing the variable according to $u\mapsto \eps^\frac{1}{2}u$,

\begin{equation*}\begin{aligned}
G_\eps f(x)=&\tilde{f}(0)\int_{\Real^d}h\left(||u||^2 \right)du + \frac{\eps}{2}\left(\sum\limits_{i=1}^d \frac{\partial^2 \tilde{f}}{\partial s_i^2}(0) \right)\int_{\Real^d}u_1^2 h\left(||u||^2\right)du \\
+&\eps\tilde{f}(0)\int_{\Real^d}\left(Q_{x,4}(u)h'\left(||u||^2\right) + Q_{x,2}(u)h\left(||u||^2\right)\right)du + \mathcal{O}(\eps^2),
\end{aligned}\end{equation*}

where we have used the homogeneity of $Q_{x,2}$ and $Q_{x,4}$. Finally, observing that

\begin{equation*}
\tilde{f}(0) = f(x) \text{ and } \sum_{i=1}^d \frac{\partial^2 \tilde{f}}{\partial s_i^2}(0) = -\Delta f(x),
\end{equation*}

we end up with

\begin{equation*}
G_\eps f(x)=m_0 f(x)+\eps\frac{m_2}{2}\left(\omega(x)f(x)-\Delta f(x) \right)+\mathcal{O}(\eps^2),
\end{equation*}

where

\begin{equation*}
\omega(x)=\frac{2}{m_2}\int_{\Real^d}\left(Q_{x,4}(u)h'\left(||u||^2 \right) + Q_{x,2}(u)h\left(||u||^2 \right) \right)du.
\end{equation*}

Finally, the uniformity follows from the compactness and smoothness of $\Man$.
\end{proof}

One can also show the same result holds for all $x\in\Man$ at distance smaller than $\eps^\gamma$ from $\partial\Man$. For this proof we refer to \cite{Coifman20065} as this would go beyond the scope of the discussion.\\

Suppose that the data set X consists of a Riemannian manifold with a density $p(x) = e^{-U(x)}$ and let $k_\eps(x, y)$ be a Gaussian kernel (which clearly satisfies the requirements for \ref{thm:diffOpExpansion}.

\begin{theorem}\label{thm:bFPO}
The infinitesimal generator $\mathcal{H}_b\phi$ of the backward operator $T_{b,\eps}^{(\alpha)}\phi = \int_\Gamma \frac{k_\eps^{(\alpha)}(x,y)}{d_\eps^{(\alpha)}(x)} \phi(y)p(y)dy $ is $\Delta\phi - 2(1-\alpha)\nabla\phi\cdot\nabla U$.
\end{theorem}

\begin{proof}
From \ref{thm:diffOpExpansion} we see that\footnote{w.l.o.g. we assume $m_0=1$ and $m_2=2$} 

\begin{equation*}
p_\eps(x)=p(x)+\eps (\Delta p(x)+ \omega(x)p(x))+\mathcal{O}(\eps^2)
\end{equation*}

and consequently,

\begin{equation*}
p_\eps^{-\alpha}=p^{-\alpha}\left(1-\alpha\eps \left(\frac{\Delta p}{p}+\omega \right) \right)(1+\mathcal{O}(\eps^2)).
\end{equation*}

Let

\begin{equation*}
k_\eps^{(\alpha)}(x,y)=\frac{k_\eps(x,y)}{p_\eps^{\alpha}(x)p_\eps^{\alpha}(y)}
\end{equation*}

Then, the normalization factor $d_\eps^{(\alpha)}$ is given by

\begin{equation*}
d_\eps^{(\alpha)}(x)=\int_\Gamma k_\eps^{(\alpha)}(x,y)p(y)dy = 
p_\eps^{-\alpha}(x)p_\eps^{1-\alpha}(x)\left[1+\eps \left((1-\alpha)\omega - \alpha\frac{\Delta p}{p}+\frac{\Delta p^{1-\alpha}}{p^{1-\alpha}(x)} \right) \right].
\end{equation*}

Therefore, the asymptotic expansion of the backward operator gives

\begin{equation*}
T_b^{(\alpha)}\phi = \int_\Gamma \frac{k_\eps^{(\alpha)}(x,y)}{d_\eps^{(\alpha)}(x)}\phi(y)p(y)dy = \phi(x) + \eps\left(\frac{\Delta(\phi p^{1-\alpha})}{p^{1-\alpha}}-\phi \frac{\Delta p^{1-\alpha}}{p^{1-\alpha}} \right)
\end{equation*}

and its infinitesimal generator is 

\begin{equation*}
\mathcal{H}_b\phi =
lim_{\eps\rightarrow 0}\frac{T_b-I}{\eps}\phi =
\frac{\Delta(\phi p^{1-\alpha})}{p^{1-\alpha}}-\phi \frac{\Delta p^{1-\alpha}}{p^{1-\alpha}}.
\end{equation*}

Plugging in $p=e^{-U}$ into the last equation gives the desired result.
\end{proof}

Similarly, one can show that the infinitesimal generator $\mathcal{H}_f\psi^{(\alpha)}$ of the forward operator $T_{f,\eps}^{(\alpha)}\psi$ is $\Delta\psi - 2\alpha\nabla\psi\cdot\nabla U + (2\alpha - 1)\psi(\nabla U\cdot\nabla U - \Delta U)$.


















